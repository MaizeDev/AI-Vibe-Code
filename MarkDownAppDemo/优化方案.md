Podcast Blog Studio

目标：先完整跑通功能闭环（写 → 预览 → 发布 → 删除），UI 只做到可用，后续再美化。

⸻

1. 产品定位与 MVP 边界

1.1 产品定位
	•	macOS 原生桌面应用
	•	面向：播客创作者 / 技术写作者 / 独立博客作者
	•	核心价值：
	•	用 Markdown 写文章
	•	一键发布到 GitHub Pages / 静态博客
	•	不依赖浏览器、不依赖 CMS

1.2 MVP 范围（第一阶段只做这些）

必须有
	•	文章列表（本地）
	•	新建文章
	•	编辑文章（Markdown）
	•	发布文章（推送到 GitHub 仓库）
	•	删除文章（本地 + 远端）
	•	设置页（GitHub Token + Repo 配置）

明确不做（V1 不碰）
	•	账号系统（自建）
	•	多博客支持
	•	富文本编辑
	•	协作 / 评论 / 数据统计

⸻

2. 技术选型

2.1 平台
	•	macOS 13+
	•	Swift 6+
	•	SwiftUI

2.2 核心技术栈

模块	技术
UI	SwiftUI
架构	MVVM
编辑器	TextEditor（V1）
Markdown	原生字符串 + 后续可替换
网络	URLSession
GitHub API	REST API v3
数据存储	本地文件系统（Markdown 文件）
状态管理	Swift 6 @Observable


⸻

3. 应用整体架构

PodcastBlogStudio
├─ App
│  └─ PodcastBlogStudioApp.swift
│
├─ Views
│  ├─ ContentView.swift        // 三栏主界面
│  ├─ SidebarView.swift        // 文章列表
│  ├─ EditorView.swift         // Markdown 编辑
│  ├─ ToolbarView.swift        // 新建 / 发布 / 删除
│  └─ SettingsView.swift       // GitHub 配置
│
├─ ViewModels
│  ├─ PostListViewModel.swift
│  ├─ EditorViewModel.swift
│  └─ SettingsViewModel.swift
│
├─ Models
│  ├─ Post.swift
│  └─ GitHubConfig.swift
│
├─ Services
│  ├─ FileService.swift        // 本地文件读写
│  └─ GitHubService.swift      // 发布 / 删除
│
└─ Resources
   └─ SamplePosts


⸻

4. 数据模型设计

4.1 Post 模型

struct Post: Identifiable, Codable {
    let id: UUID
    var title: String
    var content: String
    var createdAt: Date
    var updatedAt: Date
    var isPublished: Bool
    var fileName: String
}

说明：
	•	fileName 对应 GitHub 仓库中的 .md 文件名
	•	是否已发布只作为 UI 状态标识

⸻

5. 本地文章存储方案

5.1 存储位置

~/Documents/PodcastBlogStudio/posts/

5.2 文件规则
	•	每篇文章 = 一个 .md 文件
	•	文件名：yyyy-MM-dd-title.md

5.3 Markdown 结构（最简）

---
title: Podcast Script Writing Tips
date: 2026-01-29
---

正文内容...

Frontmatter 先写死，后续可解析

⸻

6. UI 结构（对应设计图）

6.1 主界面（三栏）

左侧 Sidebar
	•	List 展示 Post.title + 日期
	•	点击选中文章

中间编辑区
	•	TextEditor 绑定 post.content
	•	标题作为第一行

顶部 Toolbar
	•	➕ New：新建文章
	•	🚀 Publish：发布到 GitHub
	•	🗑 Delete：删除文章
	•	🔄 Sync：重新拉取（V1 可空实现）

右侧 Settings（或独立页面）
	•	GitHub Token
	•	Repo URL
	•	Blog URL

⸻

7. GitHub 发布流程（核心）

7.1 授权方式
	•	使用 Personal Access Token
	•	权限：repo

7.2 发布本质
	•	GitHub API 创建 / 更新文件

7.3 API 核心接口

创建或更新文件

PUT /repos/{owner}/{repo}/contents/{path}

请求体：

{
  "message": "Publish post",
  "content": "BASE64_ENCODED_MARKDOWN",
  "sha": "可选（更新时）"
}


⸻

8. GitHubService 设计

final class GitHubService {
    func publish(post: Post, config: GitHubConfig) async throws
    func delete(post: Post, config: GitHubConfig) async throws
}

	•	自动 Base64 编码
	•	失败返回错误信息

⸻

9. ViewModel 职责划分

9.1 PostListViewModel
	•	加载本地文章
	•	新建 / 删除
	•	当前选中 Post

9.2 EditorViewModel
	•	当前编辑内容
	•	自动保存（onChange）

9.3 SettingsViewModel
	•	GitHub Token 保存到 Keychain
	•	Repo / Blog URL 持久化

⸻

10. 第一阶段开发顺序（强烈建议）
	1.	创建 SwiftUI App + 三栏布局
	2.	Post 模型 + 本地文件读写
	3.	文章列表 + 编辑器联动
	4.	新建 / 删除文章
	5.	GitHub Token + Repo 配置
	6.	发布文章到 GitHub
	7.	错误处理 + Toast / Alert

⸻

11. 后续可扩展方向（不实现，仅预留）
	•	Markdown 语法高亮（Runestone）
	•	文章预览模式
	•	图片上传（GitHub assets）
	•	多仓库 / 多博客
	•	草稿箱 / 自动保存版本

⸻

最后:
 1. 分步完成,测试完成后,开始下一步
 2. 所有代码都要写注释
 3. 代码逻辑要清晰
 4. 一个文件的代码太长，要拆分,重构.


你要是有更好的思路，请提出建议让我审阅, 审核通过后，再进行修改。